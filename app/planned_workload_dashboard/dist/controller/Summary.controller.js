sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel"],function(e,t){"use strict";return e.extend("plannedworkloaddashboard.controller.Summary",{onInit(){this._oRouter=this.getOwnerComponent().getRouter();this._oRouter.getRoute("summaryView").attachPatternMatched(this._onRouteMatched,this);this.getView().setModel(new t({reportTypeLabel:"",reportType:"",inboundData:[],outboundData:[],inboundData24:[],outboundData24:[],inboundData48:[],outboundData48:[],showBothPanels:false,showInboundOnly:false,showOutboundOnly:false,showDualTimeWindows:false,selectedHours:{hours24:false,hours48:false}}),"viewModel")},_onRouteMatched(){const e=this.getOwnerComponent().getModel("navigation").getProperty("/navigationData")||{};console.log("Incoming data for SummaryView",e);this._updateViewData(e)},_updateViewData(e){const t=this.getView().getModel("viewModel");t.setProperty("/showDualTimeWindows",false);t.setProperty("/showBothPanels",false);t.setProperty("/showInboundOnly",false);t.setProperty("/showOutboundOnly",false);t.setProperty("/reportTypeLabel",e.reportTypeLabel);t.setProperty("/reportType",e.reportType);t.setProperty("/selectedHours",e.selectedHours||{hours24:false,hours48:false});const o=e.selectedHours&&e.selectedHours.hours24&&e.selectedHours.hours48;if(o){t.setProperty("/showDualTimeWindows",true);t.setProperty("/showBothPanels",false);t.setProperty("/showInboundOnly",false);t.setProperty("/showOutboundOnly",false);const o=e.inboundData?e.inboundData.filter(e=>e.Hours==="24"):[];const r=e.inboundData?e.inboundData.filter(e=>e.Hours==="48"):[];const n=e.outboundData?e.outboundData.filter(e=>e.Hours==="24"):[];const s=e.outboundData?e.outboundData.filter(e=>e.Hours==="48"):[];console.log("inbound24Data",o);console.log("inbound48Data",r);console.log("outbound24Data",n);console.log("outbound48Data",s);t.setProperty("/inboundData24",this._transformInboundTreeData(o));t.setProperty("/inboundData48",this._transformInboundTreeData(r));t.setProperty("/outboundData24",this._transformOutboundTreeData(n));t.setProperty("/outboundData48",this._transformOutboundTreeData(s));t.setProperty("/dualShowOutbound",e.reportType==="OUT"||e.reportType==="BOTH");t.setProperty("/dualShowInbound",e.reportType==="IN"||e.reportType==="BOTH")}else{t.setProperty("/showDualTimeWindows",false);t.setProperty("/showBothPanels",e.reportType==="BOTH");t.setProperty("/showInboundOnly",e.reportType==="IN");t.setProperty("/showOutboundOnly",e.reportType==="OUT");const o=this._transformInboundTreeData(e.inboundData||[]);t.setProperty("/inboundData",o);const r=this._transformOutboundTreeData(e.outboundData||[]);t.setProperty("/outboundData",r)}},_transformOutboundTreeData(e){const t=[...e].sort((e,t)=>Number(e.SequenceNumber)-Number(t.SequenceNumber));const o=[];const r=[];const n=[];const s=e=>this._parseValue(e.CurrentCompleted);t.forEach(e=>{const t=Number(e.SequenceNumber);if(t===5||t===6){r.push({QueueDescription:e.QueueDescription,CurrentCompleted:s(e).toString(),isParent:false,children:[]});return}if(t===7||t===8){n.push({QueueDescription:e.QueueDescription,CurrentCompleted:s(e).toString(),isParent:false,children:[]});return}o.push({QueueDescription:e.QueueDescription,CurrentCompleted:s(e).toString(),isParent:false,children:[]})});if(r.length){o.splice(4,0,{QueueDescription:"Scheduled Loads",CurrentCompleted:r.reduce((e,t)=>e+Number(t.CurrentCompleted),0).toString(),isParent:true,children:r})}if(n.length){o.splice(5,0,{QueueDescription:"Missed Loads",CurrentCompleted:n.reduce((e,t)=>e+Number(t.CurrentCompleted),0).toString(),isParent:true,children:n})}return o},_transformInboundTreeData(e){const t=[...e].sort((e,t)=>Number(e.SequenceNumber)-Number(t.SequenceNumber));const o=[];const r=[];const n=[];const s=e=>this._parseValue(e.CurrentCompleted);t.forEach(e=>{const t=Number(e.SequenceNumber);if(t===1||t===2||t===3){r.push({QueueDescription:e.QueueDescription,CurrentCompleted:s(e).toString(),isParent:false,children:[]});return}if(t===4||t===5){n.push({QueueDescription:e.QueueDescription,CurrentCompleted:s(e).toString(),isParent:false,children:[]});return}o.push({QueueDescription:e.QueueDescription,CurrentCompleted:s(e).toString(),isParent:true,children:[]})});if(r.length){o.splice(0,0,{QueueDescription:"Total Inbound Trucks",CurrentCompleted:r.reduce((e,t)=>e+Number(t.CurrentCompleted),0).toString(),isParent:true,children:r})}if(n.length){o.splice(1,0,{QueueDescription:"Putaway Pallets",CurrentCompleted:n.reduce((e,t)=>e+Number(t.CurrentCompleted),0).toString(),isParent:true,children:n})}return o},_parseValue(e){if(!e)return 0;const t=parseInt(e,10);return isNaN(t)?0:t},onRowsUpdated:function(e){const t=e.getSource();const o=t.getRows();const r=t.getModel("viewModel");o.forEach(function(e){const t=e.getBindingContext("viewModel");if(!t){return}const o=r.getProperty(t.getPath());if(o&&o.isParent===true){e.addStyleClass("parentRowBold");e.removeStyleClass("childRowNormal")}else{e.removeStyleClass("parentRowBold");e.addStyleClass("childRowNormal")}})},onNavBack(){this._oRouter.navTo("RouteMain")}})});
//# sourceMappingURL=Summary.controller.js.map